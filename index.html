
<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ระบบบริหารงานเอกสาร</title>
  <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --primary: #4361ee;
      --primary-light: #4895ef;
      --secondary: #f72585;
      --success: #4cc9f0;
      --warning: #fca311;
      --danger: #e63946;
      --dark: #212529;
      --light: #f8f9fa;
      --gray: #adb5bd;
      --white: #ffffff;
      --shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      --radius: 12px;
      --transition: all 0.3s ease;
    }
    
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: 'Prompt', sans-serif;
      background: linear-gradient(135deg, #f5f7fa 0%, #e4e8f0 100%);
      color: var(--dark);
      min-height: 100vh;
      padding-bottom: 80px;
    }
    
    .container {
      max-width: 480px;
      margin: 0 auto;
      padding: 16px;
    }
    
    .glass {
      background: rgba(255, 255, 255, 0.8);
      backdrop-filter: blur(10px);
      border-radius: var(--radius);
      border: 1px solid rgba(255, 255, 255, 0.3);
      box-shadow: var(--shadow);
    }
    
    /* Header */
    .header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 16px;
      margin-bottom: 16px;
      background: linear-gradient(135deg, #4361ee 0%, #3a0ca3 100%);
      color: white;
      border-radius: var(--radius);
    }
    
    .header-left {
      display: flex;
      align-items: center;
    }
    
    .logo {
      background: rgba(255, 255, 255, 0.2);
      width: 40px;
      height: 40px;
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      margin-right: 12px;
    }
    
    .title h1 {
      font-size: 18px;
      font-weight: 600;
      margin-bottom: 2px;
    }
    
    .title p {
      font-size: 12px;
      color: rgba(255, 255, 255, 0.8);
    }
    
    .notification-btn {
      position: relative;
      background: rgba(255, 255, 255, 0.2);
      border: none;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: var(--transition);
      color: white;
    }
    
    .notification-btn:hover {
      background: rgba(255, 255, 255, 0.3);
    }
    
    .notification-dot {
      position: absolute;
      top: 8px;
      right: 8px;
      width: 8px;
      height: 8px;
      background: var(--danger);
      border-radius: 50%;
    }
    
    /* Navigation */
    .nav {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 8px;
      padding: 8px;
      margin-bottom: 16px;
    }
    
    .nav-item {
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 12px;
      border-radius: var(--radius);
      cursor: pointer;
      transition: var(--transition);
      border: none;
      background: transparent;
      font-family: 'Prompt', sans-serif;
    }
    
    .nav-item:hover {
      transform: translateY(-2px);
    }
    
    .nav-item.active {
      background: rgba(67, 97, 238, 0.1);
      border-left: 3px solid var(--primary);
    }
    
    .nav-icon {
      color: var(--primary);
      margin-bottom: 6px;
    }
    
    .nav-text {
      font-size: 14px;
      font-weight: 500;
    }
    
    /* Search */
    .search {
      display: flex;
      align-items: center;
      padding: 12px 16px;
      margin-bottom: 16px;
      transition: var(--transition);
    }
    
    .search.active {
      box-shadow: 0 0 0 3px rgba(67, 97, 238, 0.3);
    }
    
    .search-icon {
      color: var(--gray);
      margin-right: 8px;
    }
    
    .search-input {
      border: none;
      background: transparent;
      width: 100%;
      outline: none;
      font-family: 'Prompt', sans-serif;
      font-size: 14px;
    }
    
    /* Tabs */
    .tabs {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 4px;
      padding: 4px;
      margin-bottom: 16px;
    }
    
    .tab {
      padding: 8px;
      text-align: center;
      border-radius: var(--radius);
      cursor: pointer;
      transition: var(--transition);
      font-size: 14px;
      border: none;
      background: transparent;
      font-family: 'Prompt', sans-serif;
    }
    
    .tab.active {
      background: var(--primary);
      color: white;
      font-weight: 500;
    }
    
    /* Content */
    .content {
      padding: 16px;
    }
    
    .content-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 16px;
    }
    
    .content-title {
      font-size: 16px;
      font-weight: 600;
    }
    
    .add-btn {
      background: var(--primary);
      color: white;
      border: none;
      padding: 6px 12px;
      border-radius: var(--radius);
      display: flex;
      align-items: center;
      cursor: pointer;
      transition: var(--transition);
      font-family: 'Prompt', sans-serif;
      font-size: 13px;
    }
    
    .add-btn:hover {
      background: var(--primary-light);
      transform: translateY(-2px);
    }
    
    .add-icon {
      margin-right: 4px;
    }
    
    /* Table */
    .table {
      width: 100%;
      border-collapse: collapse;
    }
    
    .table th {
      text-align: left;
      padding: 8px 4px;
      font-size: 13px;
      font-weight: 500;
      color: var(--gray);
      border-bottom: 1px solid rgba(0, 0, 0, 0.1);
    }
    
    .table td {
      padding: 12px 4px;
      font-size: 14px;
      border-bottom: 1px solid rgba(0, 0, 0, 0.05);
    }
    
    .table tr {
      transition: var(--transition);
    }
    
    .table tr:hover {
      background: rgba(0, 0, 0, 0.02);
    }
    
    .view-all {
      display: flex;
      align-items: center;
      justify-content: center;
      margin-top: 16px;
      color: var(--primary);
      font-size: 14px;
      cursor: pointer;
      border: none;
      background: transparent;
      font-family: 'Prompt', sans-serif;
    }
    
    .view-all:hover {
      text-decoration: underline;
    }
    
    .view-icon {
      margin-left: 4px;
    }
    
    /* Floating Action Button */
    .fab {
      position: fixed;
      bottom: 24px;
      right: 24px;
      width: 56px;
      height: 56px;
      border-radius: 50%;
      background: var(--secondary);
      color: white;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 4px 12px rgba(247, 37, 133, 0.4);
      cursor: pointer;
      transition: var(--transition);
      border: none;
    }
    
    .fab:hover {
      transform: translateY(-4px);
      box-shadow: 0 6px 16px rgba(247, 37, 133, 0.5);
    }
    
    /* Modal */
    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.5);
      z-index: 1000;
      align-items: center;
      justify-content: center;
    }
    
    .modal-content {
      width: 90%;
      max-width: 400px;
      padding: 20px;
      border-radius: var(--radius);
      background: white;
      max-height: 90vh;
      overflow-y: auto;
    }
    
    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 16px;
    }
    
    .modal-title {
      font-size: 18px;
      font-weight: 600;
    }
    
    .close-btn {
      background: transparent;
      border: none;
      font-size: 24px;
      cursor: pointer;
      color: var(--gray);
    }
    
    .form-group {
      margin-bottom: 16px;
    }
    
    .form-label {
      display: block;
      margin-bottom: 6px;
      font-size: 14px;
      font-weight: 500;
    }
    
    .form-control {
      width: 100%;
      padding: 10px 12px;
      border: 1px solid rgba(0, 0, 0, 0.1);
      border-radius: var(--radius);
      font-family: 'Prompt', sans-serif;
      font-size: 14px;
    }
    
    .form-actions {
      display: flex;
      justify-content: flex-end;
      gap: 8px;
    }
    
    .btn {
      padding: 8px 16px;
      border-radius: var(--radius);
      font-family: 'Prompt', sans-serif;
      font-size: 14px;
      cursor: pointer;
      transition: var(--transition);
      border: none;
    }
    
    .btn-cancel {
      background: var(--light);
      color: var(--dark);
    }
    
    .btn-submit {
      background: var(--primary);
      color: white;
    }
    
    .btn-submit:hover {
      background: var(--primary-light);
    }
    
    /* Loading */
    .loading {
      display: inline-block;
      width: 20px;
      height: 20px;
      border: 3px solid rgba(255, 255, 255, 0.3);
      border-radius: 50%;
      border-top-color: white;
      animation: spin 1s ease-in-out infinite;
      margin-right: 8px;
    }
    
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
    
    /* Toast */
    .toast {
      position: fixed;
      top: 20px;
      right: 20px;
      padding: 12px 16px;
      border-radius: var(--radius);
      color: white;
      font-size: 14px;
      box-shadow: var(--shadow);
      z-index: 1100;
      opacity: 0;
      transform: translateY(-20px);
      transition: all 0.3s ease;
    }
    
    .toast.show {
      opacity: 1;
      transform: translateY(0);
    }
    
    .toast-success {
      background: #10b981;
    }
    
    .toast-error {
      background: #ef4444;
    }
    
    /* Hidden */
    .hidden {
      display: none !important;
    }
    
    /* Sections */
    .section {
      display: none;
    }
    
    .section.active {
      display: block;
    }
    
    /* Tab Content */
    .tab-content {
      display: none;
    }
    
    .tab-content.active {
      display: block;
    }
    
    /* Empty State */
    .empty-state {
      text-align: center;
      padding: 24px 0;
      color: var(--gray);
    }
    
    .empty-icon {
      font-size: 40px;
      margin-bottom: 12px;
      opacity: 0.5;
    }
    
    .empty-text {
      font-size: 14px;
    }

    /* Card Style */
    .data-card {
      padding: 12px;
      border-radius: var(--radius);
      background: white;
      margin-bottom: 10px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.05);
      transition: var(--transition);
    }

    .data-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    }

    .data-card-header {
      display: flex;
      justify-content: space-between;
      margin-bottom: 2px;
    }

    .data-card-number {
      font-weight: 600;
      color: var(--primary);
    }

    .data-card-date {
      font-size: 15px;;
    }

    .data-card-subject {
      font-size: 14px;
    }


    /* Loading Skeleton */
    .skeleton {
      background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
      background-size: 200% 100%;
      animation: loading 0.1ms infinite;
      border-radius: 4px;

    }

    @keyframes loading {
      0% {
        background-position: 200% 0;
      }
      100% {
        background-position: -200% 0;
      }
    }

    .skeleton-card {
      padding: 12px;
      border-radius: var(--radius);
      background: white;
      margin-bottom: 10px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.05);
    }

    .skeleton-header {
      display: flex;
      justify-content: space-between;
      margin-bottom: 8px;
    }

    .skeleton-number {
      width: 100px;
      height: 16px;
    }

    .skeleton-date {
      width: 80px;
      height: 16px;
    }

    .skeleton-subject {
      height: 16px;
    }
    
    /* View Record Modal */
    .record-list {
      max-height: 400vx;
      overflow-y: auto;
      margin-bottom: 16px;
      width: 100%;
    }
    
    .record-item {
      padding: 12px;
      border-bottom: 1px solid rgba(0,0,0,0.05);
      cursor: pointer;
      transition: var(--transition);
    }
    
    .record-item:hover {
      background: rgba(67, 97, 238, 0.05);
    }
    
    .record-item-header {
      display: flex;
      justify-content: space-between;
      margin-bottom: 4px;
    }
    
    .record-number {
      font-weight: 600;
      color: var(--primary);
    }
    
    .record-date {
      font-size: 12px;
      color: var(--gray);
    }
    
    .record-subject {
      font-size: 14px;
    }
    
    /* Pagination */
    .pagination {
      display: flex;
      justify-content: center;
      gap: 8px;
      margin-top: 16px;
    }
    
    .page-btn {
      width: 32px;
      height: 32px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      border: 1px solid rgba(0,0,0,0.1);
      background: white;
      cursor: pointer;
      transition: var(--transition);
      font-family: 'Prompt', sans-serif;
    }
    
    .page-btn.active {
      background: var(--primary);
      color: white;
      border-color: var(--primary);
    }
    
    .page-btn:hover:not(.active) {
      background: rgba(0,0,0,0.05);
    }

    * {
    box-sizing: border-box;
    }

    .record-list {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 16px;
        padding: 16px;
        width: 100%;
        max-width: 100vw;
        overflow-x: hidden;
    }

    .skeleton-card {
        background: #f0f0f0;
        border-radius: 8px;
        padding: 16px;
    }

    .skeleton-header {
        display: flex;
        justify-content: space-between;
        margin-bottom: 8px;
    }

    .skeleton {
        background: #e0e0e0;
        border-radius: 4px;
    }

    .skeleton-number {
        width: 50px;
        height: 20px;
    }

    .skeleton-date {
        width: 100px;
        height: 20px;
    }

    .skeleton-subject {
        width: 100%;
        height: 30px;
    }


    

  </style>
</head>
<body>
  <div class="container">
    <!-- Header -->
    <div class="header">
      <div class="header-left">
        <div class="logo">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 16 16">
            <path d="M5 4a.5.5 0 0 0 0 1h6a.5.5 0 0 0 0-1H5zm-.5 2.5A.5.5 0 0 1 5 6h6a.5.5 0 0 1 0 1H5a.5.5 0 0 1-.5-.5zM5 8a.5.5 0 0 0 0 1h6a.5.5 0 0 0 0-1H5zm0 2a.5.5 0 0 0 0 1h3a.5.5 0 0 0 0-1H5z"/>
            <path d="M2 2a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V2zm10-1H4a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1z"/>
          </svg>
        </div>
        <div class="title">
          <h1>ระบบบริหารงานเอกสาร</h1>
          <p>ยินดีต้อนรับ, คุณผู้ใช้งาน</p>
        </div>
      </div>
      <button class="notification-btn" id="notificationBtn">
        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="currentColor" viewBox="0 0 16 16">
          <path d="M8 16a2 2 0 0 0 2-2H6a2 2 0 0 0 2 2zm.995-14.901a1 1 0 1 0-1.99 0A5.002 5.002 0 0 0 3 6c0 1.098-.5 6-2 7h14c-1.5-1-2-5.902-2-7 0-2.42-1.72-4.44-4.005-4.901z"/>
        </svg>
        <span class="notification-dot"></span>
      </button>
    </div>

    <!-- Navigation -->
    <div class="nav glass">
      <button class="nav-item active" data-section="registry">
        <div class="nav-icon">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 16 16">
            <path d="M5 4a.5.5 0 0 0 0 1h6a.5.5 0 0 0 0-1H5zm-.5 2.5A.5.5 0 0 1 5 6h6a.5.5 0 0 1 0 1H5a.5.5 0 0 1-.5-.5zM5 8a.5.5 0 0 0 0 1h6a.5.5 0 0 0 0-1H5zm0 2a.5.5 0 0 0 0 1h3a.5.5 0 0 0 0-1H5z"/>
            <path d="M2 2a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V2zm10-1H4a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1z"/>
          </svg>
        </div>
        <span class="nav-text">ทะเบียน</span>
      </button>
      <button class="nav-item" data-section="finance">
        <div class="nav-icon">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 16 16">
            <path d="M8 10a2 2 0 1 0 0-4 2 2 0 0 0 0 4z"/>
            <path d="M0 4a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1v8a1 1 0 0 1-1 1H1a1 1 0 0 1-1-1V4zm3 0a2 2 0 0 1-2 2v4a2 2 0 0 1 2 2h10a2 2 0 0 1 2-2V6a2 2 0 0 1-2-2H3z"/>
          </svg>
        </div>
        <span class="nav-text">การเงิน</span>
      </button>
      <button class="nav-item" data-section="procurement">
        <div class="nav-icon">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 16 16">
            <path d="M8 1a2.5 2.5 0 0 1 2.5 2.5V4h-5v-.5A2.5 2.5 0 0 1 8 1zm3.5 3v-.5a3.5 3.5 0 1 0-7 0V4H1v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V4h-3.5z"/>
          </svg>
        </div>
        <span class="nav-text">พัสดุ</span>
      </button>
    </div>

    <!-- Search -->
    <div class="search glass" id="searchContainer">
      <div class="search-icon">
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
          <path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z"/>
        </svg>
      </div>
      <input type="text" class="search-input" id="searchInput" placeholder="ค้นหาเอกสาร...">
    </div>

    <!-- Registry Section -->
    <div id="registry-section" class="section active">
      <!-- Tabs -->
      <div class="tabs glass">
        <button class="tab active" data-tab="registry-tab1">เลขที่รับ</button>
        <button class="tab" data-tab="registry-tab2">เลขที่ส่ง</button>
        <button class="tab" data-tab="registry-tab3">เลขที่คำสั่ง</button>
      </div>

      <!-- Tab Content -->
      <div id="registry-tab1" class="tab-content active glass">
        <div class="content">
          <div class="content-header">
            <h3 class="content-title">เลขที่รับเอกสาร</h3>
            <button class="add-btn" onclick="openAddModal('registry-received')">
              <span class="add-icon">+</span>
              เพิ่มรายการ
            </button>
          </div>
          <div id="registry-received-content">
            <!-- Data will be loaded here -->
            <div class="skeleton-card">
              <div class="skeleton-header">
                <div class="skeleton skeleton-number"></div>
                <div class="skeleton skeleton-date"></div>
              </div>
              <div class="skeleton skeleton-subject"></div>
              
            </div>
          </div>
          <button class="view-all" onclick="openViewAllModal('registry-received')">
            ดูทั้งหมด
            <span class="view-icon">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                <path fill-rule="evenodd" d="M4.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L10.293 8 4.646 2.354a.5.5 0 0 1 0-.708z"/>
              </svg>
            </span>
          </button>
        </div>
      </div>

      <div id="registry-tab2" class="tab-content glass hidden">
        <div class="content">
          <div class="content-header">
            <h3 class="content-title">เลขที่ส่งเอกสาร</h3>
            <button class="add-btn" onclick="openAddModal('registry-sent')">
              <span class="add-icon">+</span>
              เพิ่มรายการ
            </button>
          </div>
          <div id="registry-sent-content">
            <!-- Data will be loaded here -->
            <div class="skeleton-card">
              <div class="skeleton-header">
                <div class="skeleton skeleton-number"></div>
                <div class="skeleton skeleton-date"></div>
              </div>
              <div class="skeleton skeleton-subject"></div>
            </div>
            <div class="skeleton-card">
              <div class="skeleton-header">
                <div class="skeleton skeleton-number"></div>
                <div class="skeleton skeleton-date"></div>
              </div>
              <div class="skeleton skeleton-subject"></div>
            </div>
          </div>
          <button class="view-all" onclick="openViewAllModal('registry-sent')">
            ดูทั้งหมด
            <span class="view-icon">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                <path fill-rule="evenodd" d="M4.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L10.293 8 4.646 2.354a.5.5 0 0 1 0-.708z"/>
              </svg>
            </span>
          </button>
        </div>
      </div>

      <div id="registry-tab3" class="tab-content glass hidden">
        <div class="content">
          <div class="content-header">
            <h3 class="content-title">เลขที่คำสั่ง</h3>
            <button class="add-btn" onclick="openAddModal('registry-orders')">
              <span class="add-icon">+</span>
              เพิ่มรายการ
            </button>
          </div>
          <div id="registry-orders-content">
            <!-- Data will be loaded here -->
            <div class="skeleton-card">
              <div class="skeleton-header">
                <div class="skeleton skeleton-number"></div>
                <div class="skeleton skeleton-date"></div>
              </div>
              <div class="skeleton skeleton-subject"></div>
            </div>
            <div class="skeleton-card">
              <div class="skeleton-header">
                <div class="skeleton skeleton-number"></div>
                <div class="skeleton skeleton-date"></div>
              </div>
              <div class="skeleton skeleton-subject"></div>
            </div>
          </div>
          <button class="view-all" onclick="openViewAllModal('registry-orders')">
            ดูทั้งหมด
            <span class="view-icon">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                <path fill-rule="evenodd" d="M4.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L10.293 8 4.646 2.354a.5.5 0 0 1 0-.708z"/>
              </svg>
            </span>
          </button>
        </div>
      </div>
    </div>

    <!-- Finance Section -->
    <div id="finance-section" class="section">
      <!-- Tabs -->
      <div class="tabs glass">
        <button class="tab active" data-tab="finance-tab1">บันทึกข้อความ</button>
        <button class="tab" data-tab="finance-tab2">เลขที่</button>
        <button class="tab" data-tab="finance-tab3">เบิกจ่าย</button>
      </div>

      <!-- Tab Content -->
      <div id="finance-tab1" class="tab-content active glass">
        <div class="content">
          <div class="content-header">
            <h3 class="content-title">บันทึกข้อความการเงิน</h3>
            <button class="add-btn" onclick="openAddModal('finance-memo')">
              <span class="add-icon">+</span>
              เพิ่มรายการ
            </button>
          </div>
          <div id="finance-memo-content">
            <!-- Data will be loaded here -->
            <div class="skeleton-card">
              <div class="skeleton-header">
                <div class="skeleton skeleton-number"></div>
                <div class="skeleton skeleton-date"></div>
              </div>
              <div class="skeleton skeleton-subject"></div>
            </div>
            <div class="skeleton-card">
              <div class="skeleton-header">
                <div class="skeleton skeleton-number"></div>
                <div class="skeleton skeleton-date"></div>
              </div>
              <div class="skeleton skeleton-subject"></div>
            </div>
          </div>
          <button class="view-all" onclick="openViewAllModal('finance-memo')">
            ดูทั้งหมด
            <span class="view-icon">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                <path fill-rule="evenodd" d="M4.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L10.293 8 4.646 2.354a.5.5 0 0 1 0-.708z"/>
              </svg>
            </span>
          </button>
        </div>
      </div>

      <div id="finance-tab2" class="tab-content glass hidden">
        <div class="content">
          <div class="content-header">
            <h3 class="content-title">เลขที่การเงิน</h3>
            <button class="add-btn" onclick="openAddModal('finance-numbers')">
              <span class="add-icon">+</span>
              เพิ่มรายการ
            </button>
          </div>
          <div id="finance-numbers-content">
            <!-- Data will be loaded here -->
            <div class="skeleton-card">
              <div class="skeleton-header">
                <div class="skeleton skeleton-number"></div>
                <div class="skeleton skeleton-date"></div>
              </div>
              <div class="skeleton skeleton-subject"></div>
              <div class="deletedatatab"></div>
            </div>
            <div class="skeleton-card">
              <div class="skeleton-header">
                <div class="skeleton skeleton-number"></div>
                <div class="skeleton skeleton-date"></div>
              </div>
              <div class="skeleton skeleton-subject"></div>
            </div>
          </div>
          <button class="view-all" onclick="openViewAllModal('finance-numbers')">
            ดูทั้งหมด
            <span class="view-icon">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                <path fill-rule="evenodd" d="M4.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L10.293 8 4.646 2.354a.5.5 0 0 1 0-.708z"/>
              </svg>
            </span>
          </button>
        </div>
      </div>

      <div id="finance-tab3" class="tab-content glass hidden">
        <div class="content">
          <div class="content-header">
            <h3 class="content-title">รายการเบิกจ่าย</h3>
            <button class="add-btn" onclick="openAddModal('finance-payments')">
              <span class="add-icon">+</span>
              เพิ่มรายการ
            </button>
          </div>
          <div id="finance-payments-content">
            <!-- Data will be loaded here -->
            <div class="skeleton-card">
              <div class="skeleton-header">
                <div class="skeleton skeleton-number"></div>
                <div class="skeleton skeleton-date"></div>
              </div>
              <div class="skeleton skeleton-subject"></div>
            </div>
            <div class="skeleton-card">
              <div class="skeleton-header">
                <div class="skeleton skeleton-number"></div>
                <div class="skeleton skeleton-date"></div>
              </div>
              <div class="skeleton skeleton-subject"></div>
            </div>
          </div>
          <button class="view-all" onclick="openViewAllModal('finance-payments')">
            ดูทั้งหมด
            <span class="view-icon">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                <path fill-rule="evenodd" d="M4.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L10.293 8 4.646 2.354a.5.5 0 0 1 0-.708z"/>
              </svg>
            </span>
          </button>
        </div>
      </div>
    </div>

    <!-- Procurement Section -->
    <div id="procurement-section" class="section">
      <!-- Tabs -->
      <div class="tabs glass">
        <button class="tab active" data-tab="procurement-tab1">บันทึกข้อความ</button>
        <button class="tab" data-tab="procurement-tab2">จัดซื้อ</button>
        <button class="tab" data-tab="procurement-tab3">จัดจ้าง</button>
      </div>

      <!-- Tab Content -->
      <div id="procurement-tab1" class="tab-content active glass">
        <div class="content">
          <div class="content-header">
            <h3 class="content-title">บันทึกข้อความพัสดุ</h3>
            <button class="add-btn" onclick="openAddModal('procurement-memo')">
              <span class="add-icon">+</span>
              เพิ่มรายการ
            </button>
          </div>
          <div id="procurement-memo-content">
            <!-- Data will be loaded here -->
            <div class="skeleton-card">
              <div class="skeleton-header">
                <div class="skeleton skeleton-number"></div>
                <div class="skeleton skeleton-date"></div>
              </div>
              <div class="skeleton skeleton-subject"></div>
            </div>
            <div class="skeleton-card">
              <div class="skeleton-header">
                <div class="skeleton skeleton-number"></div>
                <div class="skeleton skeleton-date"></div>
              </div>
              <div class="skeleton skeleton-subject"></div>
            </div>
          </div>
          <button class="view-all" onclick="openViewAllModal('procurement-memo')">
            ดูทั้งหมด
            <span class="view-icon">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                <path fill-rule="evenodd" d="M4.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L10.293 8 4.646 2.354a.5.5 0 0 1 0-.708z"/>
              </svg>
            </span>
          </button>
        </div>
      </div>

      <div id="procurement-tab2" class="tab-content glass hidden">
        <div class="content">
          <div class="content-header">
            <h3 class="content-title">รายการจัดซื้อ</h3>
            <button class="add-btn" onclick="openAddModal('procurement-purchase')">
              <span class="add-icon">+</span>
              เพิ่มรายการ
            </button>
          </div>
          <div id="procurement-purchase-content">
            <!-- Data will be loaded here -->
            <div class="skeleton-card">
              <div class="skeleton-header">
                <div class="skeleton skeleton-number"></div>
                <div class="skeleton skeleton-date"></div>
              </div>
              <div class="skeleton skeleton-subject"></div>
            </div>
            <div class="skeleton-card">
              <div class="skeleton-header">
                <div class="skeleton skeleton-number"></div>
                <div class="skeleton skeleton-date"></div>
              </div>
              <div class="skeleton skeleton-subject"></div>
            </div>
          </div>
          <button class="view-all" onclick="openViewAllModal('procurement-purchase')">
            ดูทั้งหมด
            <span class="view-icon">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                <path fill-rule="evenodd" d="M4.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L10.293 8 4.646 2.354a.5.5 0 0 1 0-.708z"/>
              </svg>
            </span>
          </button>
        </div>
      </div>

      <div id="procurement-tab3" class="tab-content glass hidden">
        <div class="content">
          <div class="content-header">
            <h3 class="content-title">รายการจัดจ้าง</h3>
            <button class="add-btn" onclick="openAddModal('procurement-hire')">
              <span class="add-icon">+</span>
              เพิ่มรายการ
            </button>
          </div>
          <div id="procurement-hire-content">
            <!-- Data will be loaded here -->
            <div class="skeleton-card">
              <div class="skeleton-header">
                <div class="skeleton skeleton-number"></div>
                <div class="skeleton skeleton-date"></div>
              </div>
              <div class="skeleton skeleton-subject"></div>
            </div>
            <div class="skeleton-card">
              <div class="skeleton-header">
                <div class="skeleton skeleton-number"></div>
                <div class="skeleton skeleton-date"></div>
              </div>
              <div class="skeleton skeleton-subject"></div>
            </div>
          </div>
          <button class="view-all" onclick="openViewAllModal('procurement-hire')">
            ดูทั้งหมด
            <span class="view-icon">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                <path fill-rule="evenodd" d="M4.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L10.293 8 4.646 2.354a.5.5 0 0 1 0-.708z"/>
              </svg>
            </span>
          </button>
        </div>
      </div>
    </div>

    <!-- Floating Action Button -->
    <button class="fab" id="quickAddBtn">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 16 16">
        <path d="M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z"/>
      </svg>
    </button>
  </div>

  <!-- Add Document Modal -->
  <div id="addModal" class="modal">
    <div class="modal-content glass">
      <div class="modal-header">
        <h3 class="modal-title" id="modalTitle">เพิ่มเอกสารใหม่</h3>
        <button class="close-btn" onclick="closeModal('addModal')">&times;</button>
      </div>
      <form id="addDocumentForm">
        <input type="hidden" id="documentType" name="documentType">
        <div class="form-group">
          <label class="form-label" for="docNumber">เลขที่</label>
          <input type="text" id="docNumber" name="docNumber" class="form-control" required>
        </div>
        <div class="form-group">
          <label class="form-label" for="docDate">วันที่</label>
          <input type="date" id="docDate" name="docDate" class="form-control" required>
        </div>
        <div class="form-group">
          <label class="form-label" id="subjectLabel" for="docSubject">เรื่อง</label>
          <input type="text" id="docSubject" name="docSubject" class="form-control" required>
        </div>
        <div class="form-actions">
          <button type="button" class="btn btn-cancel" onclick="closeModal('addModal')">ยกเลิก</button>
          <button type="submit" class="btn btn-submit" id="submitBtn">บันทึก</button>
        </div>
      </form>
    </div>
  </div>

<!-- View All Records Modal -->
<div id="viewAllModal" class="modal">
    <div class="modal-content glass">
        <div class="modal-header">
            <h3 class="modal-title" id="viewAllModalTitle">รายการทั้งหมด</h3>
            <button class="close-btn" onclick="closeModal('viewAllModal')">&times;</button>
        </div>
        <div class="record-list" id="recordList">
            <!-- Records will be loaded here -->
            <div class="skeleton-card">
                <div class="skeleton-header">
                    <div class="skeleton skeleton-number"></div>
                    <div class="skeleton skeleton-date"></div>
                </div>
                <div class="skeleton skeleton-subject"></div>
            </div>
            <div class="skeleton-card">
                <div class="skeleton-header">
                    <div class="skeleton skeleton-number"></div>
                    <div class="skeleton skeleton-date"></div>
                </div>
                <div class="skeleton skeleton-subject"></div>
            </div>
        </div>
        <div class="pagination" id="pagination">
            <!-- Pagination will be generated here -->
        </div>
    </div>
</div>

  <!-- Toast Messages -->
  <div id="toast" class="toast"></div>

  <script>

    // ตั้งค่าให้เลือกฐานข้อมูลได้ ตัวเลือกที่ 1 เก็บในไฟล์ HTML (localStorage), ตัวเลือกที่ 2 Google Sheets
let databaseOption = 1; // 1 for HTML file (localStorage), 2 for Google Sheets

// ข้อมูลแผ่นงานสำหรับแต่ละประเภทเอกสาร
const SHEET_MAPPINGS = {
  'registry-received': 'ทะเบียนรับ',
  'registry-sent': 'ทะเบียนส่ง',
  'registry-orders': 'ทะเบียนคำสั่ง',
  'finance-memo': 'บันทึกข้อความการเงิน',
  'finance-numbers': 'เลขที่การเงิน',
  'finance-payments': 'รายการเบิกจ่าย',
  'procurement-memo': 'บันทึกข้อความพัสดุ',
  'procurement-purchase': 'รายการจัดซื้อ',
  'procurement-hire': 'รายการจัดจ้าง'
};

// ตัวแปรสำหรับเก็บข้อมูลการแบ่งหน้า
let currentPage = 1;
let totalPages = 1;
let currentDataType = '';
let allRecords = [];
const recordsPerPage = 10;

// ฟังก์ชันเริ่มต้นข้อมูลใน localStorage (สำหรับ databaseOption = 1)
function initializeLocalStorage() {
  if (!localStorage.getItem('documentData')) {
    const initialData = {};
    Object.keys(SHEET_MAPPINGS).forEach(key => {
      initialData[key] = [];
    });
    localStorage.setItem('documentData', JSON.stringify(initialData));
  }
}

// ฟังก์ชันดึงข้อมูลจาก localStorage
function getLocalData(dataType, limit = 0) {
  const data = JSON.parse(localStorage.getItem('documentData'))[dataType] || [];
  return limit > 0 ? data.slice(0, limit) : data;
}

// ฟังก์ชันเพิ่มข้อมูลใน localStorage
function addLocalData(dataType, data) {
  const localData = JSON.parse(localStorage.getItem('documentData'));
  localData[dataType].push(data);
  localStorage.setItem('documentData', JSON.stringify(localData));
}

// ฟังก์ชันค้นหาข้อมูลใน localStorage
function searchLocalData(dataType, query) {
  const data = getLocalData(dataType);
  return data.filter(row =>
    row[0].toLowerCase().includes(query.toLowerCase()) ||
    row[2].toLowerCase().includes(query.toLowerCase())
  );
}

// ฟังก์ชันโหลดข้อมูล
function loadData(dataType, limit = 5) {
  const contentId = `${dataType}-content`;

  // แสดงข้อความกำลังโหลด
  document.getElementById(contentId).innerHTML = `
    <div class="skeleton-card">
      <div class="skeleton-header">
        <div class="skeleton skeleton-number"></div>
        <div class="skeleton skeleton-date"></div>
      </div>
      <div class="skeleton skeleton-subject"></div>
    </div>
    <div class="skeleton-card">
      <div class="skeleton-header">
        <div class="skeleton skeleton-number"></div>
        <div class="skeleton skeleton-date"></div>
      </div>
      <div class="skeleton skeleton-subject"></div>
    </div>
  `;

  if (databaseOption === 1) {
    // โหลดจาก localStorage
    const data = getLocalData(dataType, limit);
    if (!data || data.length === 0) {
      document.getElementById(contentId).innerHTML = `
        <div class="empty-state">
          <div class="empty-icon">📄</div>
          <div class="empty-text">ไม่พบข้อมูล</div>
        </div>
      `;
      return;
    }

    // สร้าง HTML สำหรับแสดงข้อมูล
    let cardsHTML = '';
    data.forEach(row => {
      cardsHTML += `
        <div class="data-card">
          <div class="data-card-header">
            <div class="data-card-number">${row[0] || ''}</div>
            <div class="data-card-date">${formatDate(row[1]) || ''}</div>
          </div>
          <div class="data-card-subject">${row[2] || ''}</div>
        </div>
      `;
    });

    document.getElementById(contentId).innerHTML = cardsHTML;
  } else {
    // โหลดจาก Google Sheets
    google.script.run
      .withSuccessHandler(function(data) {
        if (!data || data.length === 0) {
          document.getElementById(contentId).innerHTML = `
            <div class="empty-state">
              <div class="empty-icon">📄</div>
              <div class="empty-text">ไม่พบข้อมูล</div>
            </div>
          `;
          return;
        }

        let cardsHTML = '';
        data.forEach(row => {
          cardsHTML += `
            <div class="data-card">
              <div class="data-card-header">
                <div class="data-card-number">${row[0] || ''}</div>
                <div class="data-card-date">${formatDate(row[1]) || ''}</div>
              </div>
              <div class="data-card-subject">${row[2] || ''}</div>
            </div>
          `;
        });

        document.getElementById(contentId).innerHTML = cardsHTML;
      })
      .withFailureHandler(function(error) {
        console.error('Error loading data:', error);
        document.getElementById(contentId).innerHTML = `
          <div class="empty-state">
            <div class="empty-icon">❌</div>
            <div class="empty-text">เกิดข้อผิดพลาดในการโหลดข้อมูล</div>
          </div>
        `;
      })
      .getSheetData(SHEET_MAPPINGS[dataType], limit);
  }
}

// ฟังก์ชันโหลดข้อมูลทั้งหมดสำหรับการแสดงในโมดัล
function loadAllData(dataType) {
  if (databaseOption === 1) {
    allRecords = getLocalData(dataType);
    totalPages = Math.ceil(allRecords.length / recordsPerPage);
    displayRecordsPage(1);
    generatePagination();
  } else {
    google.script.run
      .withSuccessHandler(function(data) {
        allRecords = data || [];
        totalPages = Math.ceil(allRecords.length / recordsPerPage);
        displayRecordsPage(1);
        generatePagination();
      })
      .withFailureHandler(function(error) {
        console.error('Error loading all data:', error);
        document.getElementById('recordList').innerHTML = `
          <div class="empty-state">
            <div class="empty-icon">❌</div>
            <div class="empty-text">เกิดข้อผิดพลาดในการโหลดข้อมูล</div>
          </div>
        `;
      })
      .getSheetData(SHEET_MAPPINGS[dataType], 0);
  }
}

// ฟังก์ชันแสดงข้อมูลตามหน้าที่เลือก
function displayRecordsPage(page) {
  currentPage = page;

  const start = (page - 1) * recordsPerPage;
  const end = start + recordsPerPage;
  const pageRecords = allRecords.slice(start, end);

  if (pageRecords.length === 0) {
    document.getElementById('recordList').innerHTML = `
      <div class="empty-state">
        <div class="empty-icon">📄</div>
        <div class="empty-text">ไม่พบข้อมูล</div>
      </div>
    `;
    return;
  }

  let recordsHTML = '';
  pageRecords.forEach(row => {
    recordsHTML += `
      <div class="record-item">
        <div class="record-item-header">
          <div class="record-number">${row[0] || ''}</div>
          <div class="record-date">${formatDate(row[1]) || ''}</div>
        </div>
        <div class="record-subject">${row[2] || ''}</div>
      </div>
    `;
  });

  document.getElementById('recordList').innerHTML = recordsHTML;
}

// ฟังก์ชันสร้างปุ่มแบ่งหน้า
function generatePagination() {
  const pagination = document.getElementById('pagination');
  pagination.innerHTML = '';

  if (totalPages <= 1) return;

  if (currentPage > 1) {
    const prevBtn = document.createElement('button');
    prevBtn.className = 'page-btn';
    prevBtn.innerHTML = '«';
    prevBtn.onclick = function() {
      displayRecordsPage(currentPage - 1);
      generatePagination();
    };
    pagination.appendChild(prevBtn);
  }

  let startPage = Math.max(1, currentPage - 2);
  let endPage = Math.min(totalPages, startPage + 4);

  if (endPage - startPage < 4) {
    startPage = Math.max(1, endPage - 4);
  }

  for (let i = startPage; i <= endPage; i++) {
    const pageBtn = document.createElement('button');
    pageBtn.className = 'page-btn' + (i === currentPage ? ' active' : '');
    pageBtn.textContent = i;
    pageBtn.onclick = function() {
      displayRecordsPage(i);
      generatePagination();
    };
    pagination.appendChild(pageBtn);
  }

  if (currentPage < totalPages) {
    const nextBtn = document.createElement('button');
    nextBtn.className = 'page-btn';
    nextBtn.innerHTML = '»';
    nextBtn.onclick = function() {
      displayRecordsPage(currentPage + 1);
      generatePagination();
    };
    pagination.appendChild(nextBtn);
  }
}

// ฟังก์ชันจัดรูปแบบวันที่
function formatDate(dateStr) {
  if (!dateStr) return '';

  let date;
  if (dateStr instanceof Date) {
    date = dateStr;
  } else if (typeof dateStr === 'string') {
    if (dateStr.includes('-')) {
      date = new Date(dateStr);
    } else {
      return dateStr;
    }
  } else {
    return dateStr.toString();
  }

  if (isNaN(date.getTime())) {
    return dateStr;
  }

  const day = date.getDate().toString().padStart(2, '0');
  const month = (date.getMonth() + 1).toString().padStart(2, '0');
  const year = date.getFullYear();

  return `${day}/${month}/${year}`;
}

// ฟังก์ชันเพิ่มข้อมูลใหม่
function addData(dataType, data) {
  const submitBtn = document.getElementById('submitBtn');
  const originalBtnText = submitBtn.innerHTML;
  submitBtn.innerHTML = `<div class="loading"></div> กำลังบันทึก...`;
  submitBtn.disabled = true;

  if (databaseOption === 1) {
    addLocalData(dataType, [data.docNumber, data.docDate, data.docSubject]);
    submitBtn.innerHTML = originalBtnText;
    submitBtn.disabled = false;
    closeModal('addModal');
    loadData(dataType);
    showToast('บันทึกข้อมูลสำเร็จ', 'success');
  } else {
    google.script.run
      .withSuccessHandler(function(result) {
        submitBtn.innerHTML = originalBtnText;
        submitBtn.disabled = false;
        closeModal('addModal');
        loadData(dataType);
        showToast('บันทึกข้อมูลสำเร็จ', 'success');
      })
      .withFailureHandler(function(error) {
        console.error('Error adding data:', error);
        submitBtn.innerHTML = originalBtnText;
        submitBtn.disabled = false;
        showToast('เกิดข้อผิดพลาดในการบันทึกข้อมูล', 'error');
      })
      .addSheetData(SHEET_MAPPINGS[dataType], [data.docNumber, data.docDate, data.docSubject]);
  }
}

// ฟังก์ชันค้นหาข้อมูล
function searchData(query) {
  const activeSection = document.querySelector('.section.active').id.replace('-section', '');
  const activeTab = document.querySelector(`#${activeSection}-section .tab.active`).getAttribute('data-tab');
  const dataType = getDataTypeFromTabId(activeTab);

  if (!dataType) return;

  const contentId = `${dataType}-content`;

  document.getElementById(contentId).innerHTML = `
    <div class="skeleton-card">
      <div class="skeleton-header">
        <div class="skeleton skeleton-number"></div>
        <div class="skeleton skeleton-date"></div>
      </div>
      <div class="skeleton skeleton-subject"></div>
    </div>
  `;

  if (databaseOption === 1) {
    const data = searchLocalData(dataType, query);
    if (!data || data.length === 0) {
      document.getElementById(contentId).innerHTML = `
        <div class="empty-state">
          <div class="empty-icon">🔍</div>
          <div class="empty-text">ไม่พบข้อมูลที่ตรงกับ "${query}"</div>
        </div>
      `;
      return;
    }

    let cardsHTML = '';
    data.forEach(row => {
      cardsHTML += `
        <div class="data-card">
          <div class="data-card-header">
            <div class="data-card-number">${row[0] || ''}</div>
            <div class="data-card-date">${formatDate(row[1]) || ''}</div>
          </div>
          <div class="data-card-subject">${row[2] || ''}</div>
        </div>
      `;
    });

    document.getElementById(contentId).innerHTML = cardsHTML;
  } else {
    google.script.run
      .withSuccessHandler(function(data) {
        if (!data || data.length === 0) {
          document.getElementById(contentId).innerHTML = `
            <div class="empty-state">
              <div class="empty-icon">🔍</div>
              <div class="empty-text">ไม่พบข้อมูลที่ตรงกับ "${query}"</div>
            </div>
          `;
          return;
        }

        let cardsHTML = '';
        data.forEach(row => {
          cardsHTML += `
            <div class="data-card">
              <div class="data-card-header">
                <div class="data-card-number">${row[0] || ''}</div>
                <div class="data-card-date">${formatDate(row[1]) || ''}</div>
              </div>
              <div class="data-card-subject">${row[2] || ''}</div>
            </div>
          `;
        });

        document.getElementById(contentId).innerHTML = cardsHTML;
      })
      .withFailureHandler(function(error) {
        console.error('Error searching data:', error);
        document.getElementById(contentId).innerHTML = `
          <div class="empty-state">
            <div class="empty-icon">❌</div>
            <div class="empty-text">เกิดข้อผิดพลาดในการค้นหาข้อมูล</div>
          </div>
        `;
      })
      .searchSheetData(SHEET_MAPPINGS[dataType], query);
  }
}

// ฟังก์ชันแสดงข้อความแจ้งเตือน
function showToast(message, type) {
  const toast = document.getElementById('toast');
  toast.textContent = message;
  toast.className = `toast toast-${type}`;
  toast.classList.add('show');

  setTimeout(() => {
    toast.classList.remove('show');
  }, 3000);
}

// ฟังก์ชันเปิด Modal เพิ่มเอกสาร
function openAddModal(dataType) {
  document.getElementById('documentType').value = dataType;

  let modalTitle = 'เพิ่มเอกสารใหม่';
  let subjectLabel = 'เรื่อง';

  switch(dataType) {
    case 'registry-received':
      modalTitle = 'เพิ่มเลขที่รับเอกสาร';
      break;
    case 'registry-sent':
      modalTitle = 'เพิ่มเลขที่ส่งเอกสาร';
      break;
    case 'registry-orders':
      modalTitle = 'เพิ่มเลขที่คำสั่ง';
      break;
    case 'finance-memo':
      modalTitle = 'เพิ่มบันทึกข้อความการเงิน';
      break;
    case 'finance-numbers':
      modalTitle = 'เพิ่มเลขที่การเงิน';
      subjectLabel = 'รายการ';
      break;
    case 'finance-payments':
      modalTitle = 'เพิ่มรายการเบิกจ่าย';
      subjectLabel = 'จำนวนเงิน';
      break;
    case 'procurement-memo':
      modalTitle = 'เพิ่มบันทึกข้อความพัสดุ';
      break;
    case 'procurement-purchase':
      modalTitle = 'เพิ่มรายการจัดซื้อ';
      subjectLabel = 'รายการ';
      break;
    case 'procurement-hire':
      modalTitle = 'เพิ่มรายการจัดจ้าง';
      subjectLabel = 'รายการ';
      break;
  }

  document.getElementById('modalTitle').textContent = modalTitle;
  document.getElementById('subjectLabel').textContent = subjectLabel;

  document.getElementById('docNumber').value = '';
  document.getElementById('docDate').value = new Date().toISOString().split('T')[0];
  document.getElementById('docSubject').value = '';

  document.getElementById('addModal').style.display = 'flex';
}

// ฟังก์ชันเปิด Modal แสดงรายการทั้งหมด
function openViewAllModal(dataType) {
  currentDataType = dataType;

  let modalTitle = 'รายการทั้งหมด';

  switch(dataType) {
    case 'registry-received':
      modalTitle = 'รายการเลขที่รับเอกสารทั้งหมด';
      break;
    case 'registry-sent':
      modalTitle = 'รายการเลขที่ส่งเอกสารทั้งหมด';
      break;
    case 'registry-orders':
      modalTitle = 'รายการเลขที่คำสั่งทั้งหมด';
      break;
    case 'finance-memo':
      modalTitle = 'รายการบันทึกข้อความการเงินทั้งหมด';
      break;
    case 'finance-numbers':
      modalTitle = 'รายการเลขที่การเงินทั้งหมด';
      break;
    case 'finance-payments':
      modalTitle = 'รายการเบิกจ่ายทั้งหมด';
      break;
    case 'procurement-memo':
      modalTitle = 'รายการบันทึกข้อความพัสดุทั้งหมด';
      break;
    case 'procurement-purchase':
      modalTitle = 'รายการจัดซื้อทั้งหมด';
      break;
    case 'procurement-hire':
      modalTitle = 'รายการจัดจ้างทั้งหมด';
      break;
  }

  document.getElementById('viewAllModalTitle').textContent = modalTitle;

  document.getElementById('recordList').innerHTML = `
    <div class="skeleton-card">
      <div class="skeleton-header">
        <div class="skeleton skeleton-number"></div>
        <div class="skeleton skeleton-date"></div>
      </div>
      <div class="skeleton skeleton-subject"></div>
    </div>
    <div class="skeleton-card">
      <div class="skeleton-header">
        <div class="skeleton skeleton-number"></div>
        <div class="skeleton skeleton-date"></div>
      </div>
      <div class="skeleton skeleton-subject"></div>
    </div>
  `;

  document.getElementById('viewAllModal').style.display = 'flex';

  loadAllData(dataType);
}

// ฟังก์ชันปิด Modal
function closeModal(modalId) {
  document.getElementById(modalId).style.display = 'none';
}

// ฟังก์ชันสำหรับแปลง tab ID เป็นประเภทข้อมูล
function getDataTypeFromTabId(tabId) {
  const mapping = {
    'registry-tab1': 'registry-received',
    'registry-tab2': 'registry-sent',
    'registry-tab3': 'registry-orders',
    'finance-tab1': 'finance-memo',
    'finance-tab2': 'finance-numbers',
    'finance-tab3': 'finance-payments',
    'procurement-tab1': 'procurement-memo',
    'procurement-tab2': 'procurement-purchase',
    'procurement-tab3': 'procurement-hire'
  };

  return mapping[tabId];
}

// Section Navigation
const navItems = document.querySelectorAll('.nav-item');
const sections = document.querySelectorAll('.section');

navItems.forEach(item => {
  item.addEventListener('click', () => {
    const sectionId = item.getAttribute('data-section');

    navItems.forEach(btn => btn.classList.remove('active'));
    item.classList.add('active');

    sections.forEach(section => section.classList.remove('active'));
    document.getElementById(`${sectionId}-section`).classList.add('active');

    const activeTab = document.querySelector(`#${sectionId}-section .tab.active`).getAttribute('data-tab');
    const dataType = getDataTypeFromTabId(activeTab);
    if (dataType) loadData(dataType);
  });
});

// Tab Navigation
const tabs = document.querySelectorAll('.tab');

tabs.forEach(tab => {
  tab.addEventListener('click', () => {
    const tabId = tab.getAttribute('data-tab');
    const parentSection = tab.closest('.section');

    parentSection.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
    tab.classList.add('active');

    parentSection.querySelectorAll('.tab-content').forEach(content => {
      content.classList.add('hidden');
      content.classList.remove('active');
    });
    const tabContent = document.getElementById(tabId);
    tabContent.classList.remove('hidden');
    tabContent.classList.add('active');

    const dataType = getDataTypeFromTabId(tabId);
    if (dataType) loadData(dataType);
  });
});

// Search functionality
const searchInput = document.getElementById('searchInput');
const searchContainer = document.getElementById('searchContainer');

searchInput.addEventListener('focus', () => {
  searchContainer.classList.add('active');
});

searchInput.addEventListener('blur', () => {
  searchContainer.classList.remove('active');
});

searchInput.addEventListener('keyup', (e) => {
  if (e.key === 'Enter' && searchInput.value.trim() !== '') {
    searchData(searchInput.value.trim());
  }
});

// Notification button
document.getElementById('notificationBtn').addEventListener('click', () => {
  showToast('คุณมี 3 การแจ้งเตือนใหม่', 'success');
});

// Floating Action Button
document.getElementById('quickAddBtn').addEventListener('click', () => {
  const activeSection = document.querySelector('.section.active').id.replace('-section', '');
  const activeTab = document.querySelector(`#${activeSection}-section .tab.active`).getAttribute('data-tab');
  const dataType = getDataTypeFromTabId(activeTab);

  if (dataType) {
    openAddModal(dataType);
  } else {
    showToast('กรุณาเลือกประเภทเอกสารที่ต้องการเพิ่ม', 'error');
  }
});

// Form submission
document.getElementById('addDocumentForm').addEventListener('submit', (e) => {
  e.preventDefault();

  const dataType = document.getElementById('documentType').value;
  const docNumber = document.getElementById('docNumber').value;
  const docDate = document.getElementById('docDate').value;
  const docSubject = document.getElementById('docSubject').value;

  addData(dataType, { docNumber, docDate, docSubject });
});

// โหลดข้อมูลเริ่มต้นเมื่อโหลดหน้าเว็บ
document.addEventListener('DOMContentLoaded', function() {
  if (databaseOption === 1) {
    initializeLocalStorage();
  }
  loadData('registry-received');
});

function createSkeletonCard() {
  const card = document.createElement('div');
  card.className = 'skeleton-card';
  card.innerHTML = `
    <div class="skeleton-header">
      <div class="skeleton skeleton-number"></div>
      <div class="skeleton skeleton-date"></div>
    </div>
    <div class="skeleton skeleton-subject"></div>
  `;
  return card;
}

function updateCards(containerId) {
  const container = document.getElementById(containerId);
  if (!container) return;

  const containerWidth = container.clientWidth;
  const cardMinWidth = 250;
  const gap = 16;
  const maxCardsPerRow = Math.floor((containerWidth + gap) / (cardMinWidth + gap));
  const cardCount = Math.min(maxCardsPerRow, 6); // จำกัดสูงสุด 6 cards

  container.innerHTML = '';
  for (let i = 0; i < cardCount; i++) {
    container.appendChild(createSkeletonCard());
  }
}

function updateAllTabs() {
  updateCards('recordList-received');
  updateCards('recordList-sent');
  updateCards('recordList-orders');
}

// เรียกใช้งานเมื่อโหลดและเมื่อขนาดหน้าจอเปลี่ยน
window.addEventListener('load', updateAllTabs);
window.addEventListener('resize', updateAllTabs);

// อัปเดตเมื่อ tab เปลี่ยน (ถ้ามีการสลับ tab)
document.querySelectorAll('.tab-content').forEach(tab => {
  tab.addEventListener('transitionend', () => {
    if (tab.classList.contains('active')) {
      const containerId = tab.querySelector('.record-list').id;
      updateCards(containerId);
    }
  });
});
  </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9375e6af43827b38',t:'MTc0NTgzNjQwMy4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>